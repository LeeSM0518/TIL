# Chapter 10 ) Heap

## 1. 히프란?

* 이진 트리의 하나인 **히프**는 **루트 노드가 언제나 그 트리의 최댓값 혹은 최솟값**을 가진다.
* 트리의 루트 노드가 최댓값을 가지는 히프를 **최대 히프**
* 트리의 루트 노드가 최소값을 가지는 히프를 **최소 히프**



### 1.1 ) 최대 트리

![1541665781272](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\1541665781272.png)



: **각 노드의 값이 자식 노드의 값보다 크거나 같은 트리**



### 1.2 ) 완전 이진 트리

: **완전 트리**는 높이가 h 라고 했을 때, 레벨 1부터 레벨 h-1 까지는 포화 이진트리와 마찬가지로 꽉 채워져 있다가, 마지막 레벨 h에서는 **왼쪽에서 오른쪽으로 노드가 채워져 있는 이진 트리.** 즉, 마지막 레벨 h 에서는 노드가 왼쪽부터 차례로 채워져야 합니다. 마지막 레벨 h에서는 중간에 빈 노드가 있어서는 안 됩니다. 여기서 **마지막 레벨에서는 중간에 빈 노드가 없다는 점**이 완전 이진 트리의 가장 중요한 특징 입니다.



### 1.3 ) 히프의 정의

| 구분                | 조건                                         | 루트 노드의 키 값   |
| ------------------- | -------------------------------------------- | ------------------- |
| 최대 히프(Max Heap) | (부모의 노드의 키 값) >= (자식노드의 키 값)  | 트리 전체 중 최댓값 |
| 최소 히프(Min Heap) | (부모의 노드의 키 값) <= (자식 노드의 키 값) | 트리 전체 중 최솟값 |

* **느슨한 정렬 상태란?**
* 각 노드가 모든 하위레벨의 노드보다 크거나 같지는 않습니다.
* 최대 히프의 각 노드는 하위 레벨의 모든 노드보다 값이 크지는 않습니다. 다만, 최대 히프의 각 노드는 자신의 자식 노드보다는 키 값이 크거나 같다는 점에 주의하기 바랍니다.



## 2. 히프의 추상 자료형

| 이름      | Input              | Output         | 설명                                                      |
| --------- | ------------------ | -------------- | --------------------------------------------------------- |
| 히프 생성 | 히프의 크기 n      | 히프 d         | 최대 n 개의 원소를 가질 수 있는 공백(Empty) 히프 d를 생성 |
| 히프 삭제 | 히프 h             | N/A            | 히프 제거(메모리 해제)                                    |
| 자료 추가 | 히프 h<br />자료 d | 성공/실패 여부 | 히프에 새로운 자료를 추가                                 |
| 자료 제거 | 히프 h             | 노드 n         | 히프의 루트 노드를 제거한 뒤 반환                         |



## 3. 최대 히프에서의 추가 연산

### Step-1) 트리의 마지막 자리에 임시 저장

히프에 새로운 노드가 추가되면, 새로운 노드는 먼저 트리의 가장 마지막 자리에 임시로 저장한다. 그런데 히프는 완전 이진 트리이기 때문에 가장 큰 레벨의 가장 오른쪽 위치에 노드를 추가해야 한다.



### Step-2) 부모 노드와 키 값 비교와 이동

Step-1 까지는 단지 완전 이진 트리의 조건만을 만족시킨 단계이다. 그러므로 **최대 트리** 조건에 맞게 변경해줘야 한다.

**(부모 노드의 키 값) >= (자식 노드의 키 값)**을 만족시켜주기 위해 새로 추가된 노드와 이 노드의 부모 노드 사이의 값을 비교해야 한다. 만약 새로 추가된 노드의 키 값이 더 크다면 새로 추가된 노드와 부모 노드와 위치를 교환해 주어야 한다.



## 4. 히프에서의 제거 연산

최대 히프에서 제거 연산은 다른 말로 **최댓값의 반환 연산**이라고 한다.

완전 이진 트리, 부모 노드의 값이 자식 노드의 값보다 크거나 같다는 조건을 만족시켜줘야 한다.

### Step-1) 루트 노드의 제거

히프에서 제거 연산은 언제나 루트 노드가 대상입니다.



### Step-2) 트리 마지막 자리 노드의 임시 이동

두 번째 단계는 완전 이진 트리를 만드는 단계이다. 지금은 루트 노드가 비었기 때문에 일단은 루트 노드의 빈자리를 채워야 합니다. 그러므로 히프 삽입 연산과 마찬가지로 트리의 가장 마지막 자리에 있는 노드를 입시로 루트 노드 위치로 이동시킵니다. 즉, 히프는 완전 이진 트리이기 때문에 가장 높은 레벨의 가장 오른쪽 노드를 제거하여 루트 노드의 위치로 이동시킵니다.



### Step-3) 자식 노드들과의 값 비교와 이동

부모 노드의 값이 자식 노드의 값보다 크도록 만들어 줍니다. 이때 두 개의 자식 노드 중에서 키 값이 더 큰 노드와 부모 노드를 교환해 줍니다. 이로써 완전 이진 트리이면서 동시에 각 노드의 키 값이 자식 노드의 키 값보다 큰 최대 트리가 완성이 됩니다.